/*!
 * @pixi/graphics - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/graphics is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
import{Texture as t,BaseTexture as e,BatchDrawCall as i,BatchTextureArray as r,BatchGeometry as s,UniformGroup as n,Shader as h,State as a}from"@pixi/core";import{SHAPES as o,Point as l,PI_2 as u,Matrix as p,Polygon as c,Rectangle as d,RoundedRectangle as f,Circle as y,Ellipse as g}from"@pixi/math";import{earcut as v,premultiplyTint as b,hex2rgb as m}from"@pixi/utils";import{WRAP_MODES as x,DRAW_MODES as _,BLEND_MODES as w}from"@pixi/constants";import{Bounds as P,Container as M}from"@pixi/display";var S,T;!function(t){t.MITER="miter",t.BEVEL="bevel",t.ROUND="round"}(S||(S={})),function(t){t.BUTT="butt",t.ROUND="round",t.SQUARE="square"}(T||(T={}));var D={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(t,e){if(void 0===e&&(e=20),!this.adaptive||!t||isNaN(t))return e;var i=Math.ceil(t/this.maxLength);return i<this.minSegments?i=this.minSegments:i>this.maxSegments&&(i=this.maxSegments),i}},A=function(){function e(){this.color=16777215,this.alpha=1,this.texture=t.WHITE,this.matrix=null,this.visible=!1,this.reset()}return e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t},e.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=t.WHITE,this.matrix=null,this.visible=!1},e.prototype.destroy=function(){this.texture=null,this.matrix=null},e}(),C=function(t,e){return(C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function E(t,e){function i(){this.constructor=t}C(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var I={build:function(t){t.points=t.shape.points.slice()},triangulate:function(t,e){var i=t.points,r=t.holes,s=e.points,n=e.indices;if(i.length>=6){for(var h=[],a=0;a<r.length;a++){var o=r[a];h.push(i.length/2),i=i.concat(o.points)}var l=v(i,h,2);if(!l)return;var u=s.length/2;for(a=0;a<l.length;a+=3)n.push(l[a]+u),n.push(l[a+1]+u),n.push(l[a+2]+u);for(a=0;a<i.length;a++)s.push(i[a])}}},R={build:function(t){var e,i,r=t.shape,s=t.points,n=r.x,h=r.y;if(s.length=0,t.type===o.CIRC)e=r.radius,i=r.radius;else{var a=t.shape;e=a.width,i=a.height}if(0!==e&&0!==i){var l=Math.floor(30*Math.sqrt(r.radius))||Math.floor(15*Math.sqrt(e+i));l/=2.3;for(var u=2*Math.PI/l,p=0;p<l-.5;p++)s.push(n+Math.sin(-u*p)*e,h+Math.cos(-u*p)*i);s.push(s[0],s[1])}},triangulate:function(t,e){var i=t.points,r=e.points,s=e.indices,n=r.length/2,h=n,a=t.shape,o=t.matrix,l=a.x,u=a.y;r.push(t.matrix?o.a*l+o.c*u+o.tx:l,t.matrix?o.b*l+o.d*u+o.ty:u);for(var p=0;p<i.length;p+=2)r.push(i[p],i[p+1]),s.push(n++,h,n)}},B={build:function(t){var e=t.shape,i=e.x,r=e.y,s=e.width,n=e.height,h=t.points;h.length=0,h.push(i,r,i+s,r,i+s,r+n,i,r+n)},triangulate:function(t,e){var i=t.points,r=e.points,s=r.length/2;r.push(i[0],i[1],i[2],i[3],i[6],i[7],i[4],i[5]),e.indices.push(s,s+1,s+2,s+1,s+2,s+3)}};function L(t,e,i){return t+(e-t)*i}function O(t,e,i,r,s,n,h){void 0===h&&(h=[]);for(var a=h,o=0,l=0,u=0,p=0,c=0,d=0,f=0,y=0;f<=20;++f)o=L(t,i,y=f/20),l=L(e,r,y),u=L(i,s,y),p=L(r,n,y),c=L(o,u,y),d=L(l,p,y),a.push(c,d);return a}var U={build:function(t){var e=t.shape,i=t.points,r=e.x,s=e.y,n=e.width,h=e.height,a=Math.max(0,Math.min(e.radius,Math.min(n,h)/2));i.length=0,a?(O(r,s+a,r,s,r+a,s,i),O(r+n-a,s,r+n,s,r+n,s+a,i),O(r+n,s+h-a,r+n,s+h,r+n-a,s+h,i),O(r+a,s+h,r,s+h,r,s+h-a,i)):i.push(r,s,r+n,s,r+n,s+h,r,s+h)},triangulate:function(t,e){for(var i=t.points,r=e.points,s=e.indices,n=r.length/2,h=v(i,null,2),a=0,o=h.length;a<o;a+=3)s.push(h[a]+n),s.push(h[a+1]+n),s.push(h[a+2]+n);for(a=0,o=i.length;a<o;a++)r.push(i[a],i[++a])}};function F(t,e,i,r,s,n,h,a){var o,l;h?(o=r,l=-i):(o=-r,l=i);var u=t-i*s+o,p=e-r*s+l,c=t+i*n+o,d=e+r*n+l;return a.push(u,p),a.push(c,d),2}function j(t,e,i,r,s,n,h,a){var o=i-t,l=r-e,u=Math.atan2(o,l),p=Math.atan2(s-t,n-e);a&&u<p?u+=2*Math.PI:!a&&u>p&&(p+=2*Math.PI);var c=u,d=p-u,f=Math.abs(d),y=Math.sqrt(o*o+l*l),g=1+(15*f*Math.sqrt(y)/Math.PI>>0),v=d/g;if(c+=v,a){h.push(t,e),h.push(i,r);for(var b=1,m=c;b<g;b++,m+=v)h.push(t,e),h.push(t+Math.sin(m)*y,e+Math.cos(m)*y);h.push(t,e),h.push(s,n)}else{h.push(i,r),h.push(t,e);for(b=1,m=c;b<g;b++,m+=v)h.push(t+Math.sin(m)*y,e+Math.cos(m)*y),h.push(t,e);h.push(s,n),h.push(t,e)}return 2*g}function N(t,e){t.lineStyle.native?function(t,e){var i=0,r=t.shape,s=t.points||r.points,n=r.type!==o.POLY||r.closeStroke;if(0!==s.length){var h=e.points,a=e.indices,l=s.length/2,u=h.length/2,p=u;for(h.push(s[0],s[1]),i=1;i<l;i++)h.push(s[2*i],s[2*i+1]),a.push(p,p+1),p++;n&&a.push(p,u)}}(t,e):function(t,e){var i=t.shape,r=t.points||i.points.slice(),s=e.closePointEps;if(0!==r.length){var n=t.lineStyle,h=new l(r[0],r[1]),a=new l(r[r.length-2],r[r.length-1]),u=i.type!==o.POLY||i.closeStroke,p=Math.abs(h.x-a.x)<s&&Math.abs(h.y-a.y)<s;if(u){r=r.slice(),p&&(r.pop(),r.pop(),a.set(r[r.length-2],r[r.length-1]));var c=.5*(h.x+a.x),d=.5*(a.y+h.y);r.unshift(c,d),r.push(c,d)}var f=e.points,y=r.length/2,g=r.length,v=f.length/2,b=n.width/2,m=b*b,x=n.miterLimit*n.miterLimit,_=r[0],w=r[1],P=r[2],M=r[3],A=0,C=0,E=-(w-M),I=_-P,R=0,B=0,L=Math.sqrt(E*E+I*I);E/=L,I/=L,E*=b,I*=b;var O=n.alignment,U=2*(1-O),N=2*O;u||(n.cap===T.ROUND?g+=j(_-E*(U-N)*.5,w-I*(U-N)*.5,_-E*U,w-I*U,_+E*N,w+I*N,f,!0)+2:n.cap===T.SQUARE&&(g+=F(_,w,E,I,U,N,!0,f))),f.push(_-E*U,w-I*U),f.push(_+E*N,w+I*N);for(var z=1;z<y-1;++z){_=r[2*(z-1)],w=r[2*(z-1)+1],P=r[2*z],M=r[2*z+1],A=r[2*(z+1)],C=r[2*(z+1)+1],E=-(w-M),I=_-P,E/=L=Math.sqrt(E*E+I*I),I/=L,E*=b,I*=b,R=-(M-C),B=P-A,R/=L=Math.sqrt(R*R+B*B),B/=L,R*=b,B*=b;var q=P-_,k=w-M,H=P-A,Y=C-M,G=k*H-Y*q,V=G<0;if(Math.abs(G)<.1)f.push(P-E*U,M-I*U),f.push(P+E*N,M+I*N);else{var W=(-E+_)*(-I+M)-(-E+P)*(-I+w),Q=(-R+A)*(-B+M)-(-R+P)*(-B+C),X=(q*Q-H*W)/G,Z=(Y*W-k*Q)/G,J=(X-P)*(X-P)+(Z-M)*(Z-M),K=P+(X-P)*U,$=M+(Z-M)*U,tt=P-(X-P)*N,et=M-(Z-M)*N,it=V?U:N;J<=Math.min(q*q+k*k,H*H+Y*Y)+it*it*m?n.join===S.BEVEL||J/m>x?(V?(f.push(K,$),f.push(P+E*N,M+I*N),f.push(K,$),f.push(P+R*N,M+B*N)):(f.push(P-E*U,M-I*U),f.push(tt,et),f.push(P-R*U,M-B*U),f.push(tt,et)),g+=2):n.join===S.ROUND?V?(f.push(K,$),f.push(P+E*N,M+I*N),g+=j(P,M,P+E*N,M+I*N,P+R*N,M+B*N,f,!0)+4,f.push(K,$),f.push(P+R*N,M+B*N)):(f.push(P-E*U,M-I*U),f.push(tt,et),g+=j(P,M,P-E*U,M-I*U,P-R*U,M-B*U,f,!1)+4,f.push(P-R*U,M-B*U),f.push(tt,et)):(f.push(K,$),f.push(tt,et)):(f.push(P-E*U,M-I*U),f.push(P+E*N,M+I*N),n.join===S.BEVEL||J/m>x||(n.join===S.ROUND?g+=V?j(P,M,P+E*N,M+I*N,P+R*N,M+B*N,f,!0)+2:j(P,M,P-E*U,M-I*U,P-R*U,M-B*U,f,!1)+2:(V?(f.push(tt,et),f.push(tt,et)):(f.push(K,$),f.push(K,$)),g+=2)),f.push(P-R*U,M-B*U),f.push(P+R*N,M+B*N),g+=2)}}_=r[2*(y-2)],w=r[2*(y-2)+1],P=r[2*(y-1)],E=-(w-(M=r[2*(y-1)+1])),I=_-P,E/=L=Math.sqrt(E*E+I*I),I/=L,E*=b,I*=b,f.push(P-E*U,M-I*U),f.push(P+E*N,M+I*N),u||(n.cap===T.ROUND?g+=j(P-E*(U-N)*.5,M-I*(U-N)*.5,P-E*U,M-I*U,P+E*N,M+I*N,f,!1)+2:n.cap===T.SQUARE&&(g+=F(P,M,E,I,U,N,!1,f)));var rt=e.indices,st=D.epsilon*D.epsilon;for(z=v;z<g+v-2;++z)_=f[2*z],w=f[2*z+1],P=f[2*(z+1)],M=f[2*(z+1)+1],A=f[2*(z+2)],C=f[2*(z+2)+1],Math.abs(_*(M-C)+P*(C-w)+A*(w-M))<st||rt.push(z,z+1,z+2)}}(t,e)}var z,q=function(){function t(){}return t.curveTo=function(t,e,i,r,s,n){var h=n[n.length-2],a=n[n.length-1]-e,o=h-t,l=r-e,u=i-t,p=Math.abs(a*u-o*l);if(p<1e-8||0===s)return n[n.length-2]===t&&n[n.length-1]===e||n.push(t,e),null;var c=a*a+o*o,d=l*l+u*u,f=a*l+o*u,y=s*Math.sqrt(c)/p,g=s*Math.sqrt(d)/p,v=y*f/c,b=g*f/d,m=y*u+g*o,x=y*l+g*a,_=o*(g+v),w=a*(g+v),P=u*(y+b),M=l*(y+b);return{cx:m+t,cy:x+e,radius:s,startAngle:Math.atan2(w-x,_-m),endAngle:Math.atan2(M-x,P-m),anticlockwise:o*l>u*a}},t.arc=function(t,e,i,r,s,n,h,a,o){for(var l=h-n,p=D._segmentsCount(Math.abs(l)*s,40*Math.ceil(Math.abs(l)/u)),c=l/(2*p),d=2*c,f=Math.cos(c),y=Math.sin(c),g=p-1,v=g%1/g,b=0;b<=g;++b){var m=c+n+d*(b+v*b),x=Math.cos(m),_=-Math.sin(m);o.push((f*x+y*_)*s+i,(f*-_+y*x)*s+r)}},t}(),k=function(){function t(){}return t.curveLength=function(t,e,i,r,s,n,h,a){for(var o=0,l=0,u=0,p=0,c=0,d=0,f=0,y=0,g=0,v=0,b=0,m=t,x=e,_=1;_<=10;++_)v=m-(y=(f=(d=(c=1-(l=_/10))*c)*c)*t+3*d*l*i+3*c*(u=l*l)*s+(p=u*l)*h),b=x-(g=f*e+3*d*l*r+3*c*u*n+p*a),m=y,x=g,o+=Math.sqrt(v*v+b*b);return o},t.curveTo=function(e,i,r,s,n,h,a){var o=a[a.length-2],l=a[a.length-1];a.length-=2;var u=D._segmentsCount(t.curveLength(o,l,e,i,r,s,n,h)),p=0,c=0,d=0,f=0,y=0;a.push(o,l);for(var g=1,v=0;g<=u;++g)d=(c=(p=1-(v=g/u))*p)*p,y=(f=v*v)*v,a.push(d*o+3*c*v*e+3*p*f*r+y*n,d*l+3*c*v*i+3*p*f*s+y*h)},t}(),H=function(){function t(){}return t.curveLength=function(t,e,i,r,s,n){var h=t-2*i+s,a=e-2*r+n,o=2*i-2*t,l=2*r-2*e,u=4*(h*h+a*a),p=4*(h*o+a*l),c=o*o+l*l,d=2*Math.sqrt(u+p+c),f=Math.sqrt(u),y=2*u*f,g=2*Math.sqrt(c),v=p/f;return(y*d+f*p*(d-g)+(4*c*u-p*p)*Math.log((2*f+v+d)/(v+g)))/(4*y)},t.curveTo=function(e,i,r,s,n){for(var h=n[n.length-2],a=n[n.length-1],o=D._segmentsCount(t.curveLength(h,a,e,i,r,s)),l=0,u=0,p=1;p<=o;++p){var c=p/o;l=h+(e-h)*c,u=a+(i-a)*c,n.push(l+(e+(r-e)*c-l)*c,u+(i+(s-i)*c-u)*c)}},t}(),Y=function(){function t(){this.reset()}return t.prototype.begin=function(t,e,i){this.reset(),this.style=t,this.start=e,this.attribStart=i},t.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},t.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},t}(),G=((z={})[o.POLY]=I,z[o.CIRC]=R,z[o.ELIP]=R,z[o.RECT]=B,z[o.RREC]=U,z),V=[],W=[],Q=function(){function t(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=null),this.shape=t,this.lineStyle=i,this.fillStyle=e,this.matrix=r,this.type=t.type,this.points=[],this.holes=[]}return t.prototype.clone=function(){return new t(this.shape,this.fillStyle,this.lineStyle,this.matrix)},t.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},t}(),X=new l,Z=new P,J=function(t){function s(){var e=t.call(this)||this;return e.uvsFloat32=null,e.indicesUint16=null,e.points=[],e.colors=[],e.uvs=[],e.indices=[],e.textureIds=[],e.graphicsData=[],e.dirty=0,e.batchDirty=-1,e.cacheDirty=-1,e.clearDirty=0,e.drawCalls=[],e.batches=[],e.shapeIndex=0,e._bounds=new P,e.boundsDirty=-1,e.boundsPadding=0,e.batchable=!1,e.indicesUint16=null,e.uvsFloat32=null,e.closePointEps=1e-4,e}return E(s,t),Object.defineProperty(s.prototype,"bounds",{get:function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),s.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),W.push(this.drawCalls[t]);this.drawCalls.length=0;for(t=0;t<this.batches.length;t++){var e=this.batches[t];e.reset(),V.push(e)}this.batches.length=0},s.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},s.prototype.drawShape=function(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=null);var s=new Q(t,e,i,r);return this.graphicsData.push(s),this.dirty++,this},s.prototype.drawHole=function(t,e){if(void 0===e&&(e=null),!this.graphicsData.length)return null;var i=new Q(t,null,null,e),r=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=r.lineStyle,r.holes.push(i),this.dirty++,this},s.prototype.destroy=function(){t.prototype.destroy.call(this);for(var e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},s.prototype.containsPoint=function(t){for(var e=this.graphicsData,i=0;i<e.length;++i){var r=e[i];if(r.fillStyle.visible&&(r.shape&&(r.matrix?r.matrix.applyInverse(t,X):X.copyFrom(t),r.shape.contains(X.x,X.y)))){var s=!1;if(r.holes)for(var n=0;n<r.holes.length;n++){if(r.holes[n].shape.contains(X.x,X.y)){s=!0;break}}if(!s)return!0}}return!1},s.prototype.updateBatches=function(t){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var e=this.uvs,i=this.graphicsData,r=null,s=null;this.batches.length>0&&(s=(r=this.batches[this.batches.length-1]).style);for(var n=this.shapeIndex;n<i.length;n++){this.shapeIndex++;var h=i[n],a=h.fillStyle,o=h.lineStyle;G[h.type].build(h),h.matrix&&this.transformPoints(h.points,h.matrix);for(var l=0;l<2;l++){var u=0===l?a:o;if(u.visible){var p=u.texture.baseTexture,c=this.indices.length,d=this.points.length/2;p.wrapMode=x.REPEAT,0===l?this.processFill(h):this.processLine(h);var f=this.points.length/2-d;0!==f&&(r&&!this._compareStyles(s,u)&&(r.end(c,d),r=null),r||((r=V.pop()||new Y).begin(u,c,d),this.batches.push(r),s=u),this.addUvs(this.points,e,u.texture,d,f,u.matrix))}}}var y=this.indices.length,g=this.points.length/2;if(r&&r.end(y,g),0!==this.batches.length){if(this.indicesUint16&&this.indices.length===this.indicesUint16.length)this.indicesUint16.set(this.indices);else{var v=g>65535&&t;this.indicesUint16=v?new Uint32Array(this.indices):new Uint16Array(this.indices)}this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}else this.batchable=!0}}else this.batchable=!0},s.prototype._compareStyles=function(t,e){return!(!t||!e)&&(t.texture.baseTexture===e.texture.baseTexture&&(t.color+t.alpha===e.color+e.alpha&&!!t.native==!!e.native))},s.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,e=this.graphicsData.length;t<e;t++){var i=this.graphicsData[t],r=i.fillStyle,s=i.lineStyle;if(r&&!r.texture.baseTexture.valid)return!1;if(s&&!s.texture.baseTexture.valid)return!1}return!0},s.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,e=0,i=t.length;e<i;e++)for(var r=t[e],s=0;s<r.size;s++){var n=r.start+s;this.indicesUint16[n]=this.indicesUint16[n]-r.attribStart}},s.prototype.isBatchable=function(){if(this.points.length>131070)return!1;for(var t=this.batches,e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<2*s.BATCHABLE_SIZE},s.prototype.buildDrawCalls=function(){for(var t=++e._globalBatch,s=0;s<this.drawCalls.length;s++)this.drawCalls[s].texArray.clear(),W.push(this.drawCalls[s]);this.drawCalls.length=0;var n=this.colors,h=this.textureIds,a=W.pop();a||((a=new i).texArray=new r),a.texArray.count=0,a.start=0,a.size=0,a.type=_.TRIANGLES;var o=0,l=null,u=0,p=!1,c=_.TRIANGLES,d=0;this.drawCalls.push(a);for(s=0;s<this.batches.length;s++){var f=this.batches[s],y=f.style,g=y.texture.baseTexture;p!==!!y.native&&(c=(p=!!y.native)?_.LINES:_.TRIANGLES,l=null,o=8,t++),l!==g&&(l=g,g._batchEnabled!==t&&(8===o&&(t++,o=0,a.size>0&&((a=W.pop())||((a=new i).texArray=new r),this.drawCalls.push(a)),a.start=d,a.size=0,a.texArray.count=0,a.type=c),g.touched=1,g._batchEnabled=t,g._batchLocation=o,g.wrapMode=x.REPEAT,a.texArray.elements[a.texArray.count++]=g,o++)),a.size+=f.size,d+=f.size,u=g._batchLocation,this.addColors(n,y.color,y.alpha,f.attribSize),this.addTextureIds(h,u,f.attribSize)}e._globalBatch=t,this.packAttributes()},s.prototype.packAttributes=function(){for(var t=this.points,e=this.uvs,i=this.colors,r=this.textureIds,s=new ArrayBuffer(3*t.length*4),n=new Float32Array(s),h=new Uint32Array(s),a=0,o=0;o<t.length/2;o++)n[a++]=t[2*o],n[a++]=t[2*o+1],n[a++]=e[2*o],n[a++]=e[2*o+1],h[a++]=i[o],n[a++]=r[o];this._buffer.update(s),this._indexBuffer.update(this.indicesUint16)},s.prototype.processFill=function(t){t.holes.length?(this.processHoles(t.holes),I.triangulate(t,this)):G[t.type].triangulate(t,this)},s.prototype.processLine=function(t){N(t,this);for(var e=0;e<t.holes.length;e++)N(t.holes[e],this)},s.prototype.processHoles=function(t){for(var e=0;e<t.length;e++){var i=t[e];G[i.type].build(i),i.matrix&&this.transformPoints(i.points,i.matrix)}},s.prototype.calculateBounds=function(){var t=this._bounds,e=Z,i=p.IDENTITY;this._bounds.clear(),e.clear();for(var r=0;r<this.graphicsData.length;r++){var s=this.graphicsData[r],n=s.shape,h=s.type,a=s.lineStyle,l=s.matrix||p.IDENTITY,u=0;if(a&&a.visible){var c=a.alignment;u=a.width,h===o.POLY?u*=.5+Math.abs(.5-c):u*=Math.max(0,c)}if(i!==l&&(e.isEmpty()||(t.addBoundsMatrix(e,i),e.clear()),i=l),h===o.RECT||h===o.RREC){var d=n;e.addFramePad(d.x,d.y,d.x+d.width,d.y+d.height,u,u)}else if(h===o.CIRC){var f=n;e.addFramePad(f.x,f.y,f.x,f.y,f.radius+u,f.radius+u)}else if(h===o.ELIP){var y=n;e.addFramePad(y.x,y.y,y.x,y.y,y.width+u,y.height+u)}else{var g=n;t.addVerticesMatrix(i,g.points,0,g.points.length,u,u)}}e.isEmpty()||t.addBoundsMatrix(e,i),t.pad(this.boundsPadding,this.boundsPadding)},s.prototype.transformPoints=function(t,e){for(var i=0;i<t.length/2;i++){var r=t[2*i],s=t[2*i+1];t[2*i]=e.a*r+e.c*s+e.tx,t[2*i+1]=e.b*r+e.d*s+e.ty}},s.prototype.addColors=function(t,e,i,r){for(var s=b((e>>16)+(65280&e)+((255&e)<<16),i);r-- >0;)t.push(s)},s.prototype.addTextureIds=function(t,e,i){for(;i-- >0;)t.push(e)},s.prototype.addUvs=function(t,e,i,r,s,n){void 0===n&&(n=null);for(var h=0,a=e.length,o=i.frame;h<s;){var l=t[2*(r+h)],u=t[2*(r+h)+1];if(n){var p=n.a*l+n.c*u+n.tx;u=n.b*l+n.d*u+n.ty,l=p}h++,e.push(l/o.width,u/o.height)}var c=i.baseTexture;(o.width<c.width||o.height<c.height)&&this.adjustUvs(e,i,a,s)},s.prototype.adjustUvs=function(t,e,i,r){for(var s=e.baseTexture,n=i+2*r,h=e.frame,a=h.width/s.width,o=h.height/s.height,l=h.x/h.width,u=h.y/h.height,p=Math.floor(t[i]+1e-6),c=Math.floor(t[i+1]+1e-6),d=i+2;d<n;d+=2)p=Math.min(p,Math.floor(t[d]+1e-6)),c=Math.min(c,Math.floor(t[d+1]+1e-6));l-=p,u-=c;for(d=i;d<n;d+=2)t[d]=(t[d]+l)*a,t[d+1]=(t[d+1]+u)*o},s.BATCHABLE_SIZE=100,s}(s),K=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.width=0,e.alignment=.5,e.native=!1,e.cap=T.BUTT,e.join=S.MITER,e.miterLimit=10,e}return E(e,t),e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t},e.prototype.reset=function(){t.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},e}(A),$=new Float32Array(3),tt={},et=function(e){function i(t){void 0===t&&(t=null);var i=e.call(this)||this;return i._geometry=t||new J,i._geometry.refCount++,i.shader=null,i.state=a.for2d(),i._fillStyle=new A,i._lineStyle=new K,i._matrix=null,i._holeMode=!1,i.currentPath=null,i.batches=[],i.batchTint=-1,i.batchDirty=-1,i.vertexData=null,i.pluginName="batch",i._transformID=-1,i.tint=16777215,i.blendMode=w.NORMAL,i}return E(i,e),Object.defineProperty(i.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),i.prototype.clone=function(){return this.finishPoly(),new i(this._geometry)},Object.defineProperty(i.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),i.prototype.lineStyle=function(t,e,i,r,s){return void 0===t&&(t=null),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=.5),void 0===s&&(s=!1),"number"==typeof t&&(t={width:t,color:e,alpha:i,alignment:r,native:s}),this.lineTextureStyle(t)},i.prototype.lineTextureStyle=function(e){e=Object.assign({width:0,texture:t.WHITE,color:e&&e.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:T.BUTT,join:S.MITER,miterLimit:10},e),this.currentPath&&this.startPoly();var i=e.width>0&&e.alpha>0;return i?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:i},e)):this._lineStyle.reset(),this},i.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new c,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new c,this.currentPath.closeStroke=!1},i.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},i.prototype.moveTo=function(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this},i.prototype.lineTo=function(t,e){this.currentPath||this.moveTo(0,0);var i=this.currentPath.points,r=i[i.length-2],s=i[i.length-1];return r===t&&s===e||i.push(t,e),this},i.prototype._initCurve=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)},i.prototype.quadraticCurveTo=function(t,e,i,r){this._initCurve();var s=this.currentPath.points;return 0===s.length&&this.moveTo(0,0),H.curveTo(t,e,i,r,s),this},i.prototype.bezierCurveTo=function(t,e,i,r,s,n){return this._initCurve(),k.curveTo(t,e,i,r,s,n,this.currentPath.points),this},i.prototype.arcTo=function(t,e,i,r,s){this._initCurve(t,e);var n=this.currentPath.points,h=q.curveTo(t,e,i,r,s,n);if(h){var a=h.cx,o=h.cy,l=h.radius,u=h.startAngle,p=h.endAngle,c=h.anticlockwise;this.arc(a,o,l,u,p,c)}return this},i.prototype.arc=function(t,e,i,r,s,n){if(void 0===n&&(n=!1),r===s)return this;if(!n&&s<=r?s+=u:n&&r<=s&&(r+=u),0===s-r)return this;var h=t+Math.cos(r)*i,a=e+Math.sin(r)*i,o=this._geometry.closePointEps,l=this.currentPath?this.currentPath.points:null;if(l){var p=Math.abs(l[l.length-2]-h),c=Math.abs(l[l.length-1]-a);p<o&&c<o||l.push(h,a)}else this.moveTo(h,a),l=this.currentPath.points;return q.arc(h,a,t,e,i,r,s,n,l),this},i.prototype.beginFill=function(e,i){return void 0===e&&(e=0),void 0===i&&(i=1),this.beginTextureFill({texture:t.WHITE,color:e,alpha:i})},i.prototype.beginTextureFill=function(e){e=Object.assign({texture:t.WHITE,color:16777215,alpha:1,matrix:null},e),this.currentPath&&this.startPoly();var i=e.alpha>0;return i?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:i},e)):this._fillStyle.reset(),this},i.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},i.prototype.drawRect=function(t,e,i,r){return this.drawShape(new d(t,e,i,r))},i.prototype.drawRoundedRect=function(t,e,i,r,s){return this.drawShape(new f(t,e,i,r,s))},i.prototype.drawCircle=function(t,e,i){return this.drawShape(new y(t,e,i))},i.prototype.drawEllipse=function(t,e,i,r){return this.drawShape(new g(t,e,i,r))},i.prototype.drawPolygon=function(){for(var t,e=arguments,i=[],r=0;r<arguments.length;r++)i[r]=e[r];var s=!0,n=i[0];n.points?(s=n.closeStroke,t=n.points):t=Array.isArray(i[0])?i[0]:i;var h=new c(t);return h.closeStroke=s,this.drawShape(h),this},i.prototype.drawShape=function(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},i.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},i.prototype.isFastRect=function(){var t=this._geometry.graphicsData;return!(1!==t.length||t[0].shape.type!==o.RECT||t[0].holes.length||t[0].lineStyle.visible&&t[0].lineStyle.width)},i.prototype._render=function(t){this.finishPoly();var e=this._geometry,i=t.context.supports.uint32Indices;e.updateBatches(i),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},i.prototype._populateBatches=function(){var t=this._geometry,e=this.blendMode,i=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=i,this.vertexData=new Float32Array(t.points);for(var r=0;r<i;r++){var s=t.batches[r],n=s.style.color,h=new Float32Array(this.vertexData.buffer,4*s.attribStart*2,2*s.attribSize),a=new Float32Array(t.uvsFloat32.buffer,4*s.attribStart*2,2*s.attribSize),o={vertexData:h,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*s.start,s.size),uvs:a,_batchRGB:m(n),_tintRGB:n,_texture:s.style.texture,alpha:s.style.alpha,worldAlpha:1};this.batches[r]=o}},i.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var e=0,i=this.batches.length;e<i;e++){var r=this.batches[e];r.worldAlpha=this.worldAlpha*r.alpha,t.plugins[this.pluginName].render(r)}}},i.prototype._renderDirect=function(t){var e=this._resolveDirectShader(t),i=this._geometry,r=this.tint,s=this.worldAlpha,n=e.uniforms,h=i.drawCalls;n.translationMatrix=this.transform.worldTransform,n.tint[0]=(r>>16&255)/255*s,n.tint[1]=(r>>8&255)/255*s,n.tint[2]=(255&r)/255*s,n.tint[3]=s,t.shader.bind(e),t.geometry.bind(i,e),t.state.set(this.state);for(var a=0,o=h.length;a<o;a++)this._renderDrawCallDirect(t,i.drawCalls[a])},i.prototype._renderDrawCallDirect=function(t,e){for(var i=e.texArray,r=e.type,s=e.size,n=e.start,h=i.count,a=0;a<h;a++)t.texture.bind(i.elements[a],a);t.geometry.draw(r,s,n)},i.prototype._resolveDirectShader=function(t){var e=this.shader,i=this.pluginName;if(!e){if(!tt[i]){for(var r=t.plugins.batch.MAX_TEXTURES,s=new Int32Array(r),a=0;a<r;a++)s[a]=a;var o={tint:new Float32Array([1,1,1,1]),translationMatrix:new p,default:n.from({uSamplers:s},!0)},l=t.plugins[i]._shader.program;tt[i]=new h(l,o)}e=tt[i]}return e},i.prototype._calculateBounds=function(){this.finishPoly();var t=this._geometry;if(t.graphicsData.length){var e=t.bounds,i=e.minX,r=e.minY,s=e.maxX,n=e.maxY;this._bounds.addFrame(this.transform,i,r,s,n)}},i.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,i._TEMP_POINT),this._geometry.containsPoint(i._TEMP_POINT)},i.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=m(this.tint,$),e=0;e<this.batches.length;e++){var i=this.batches[e],r=i._batchRGB,s=(t[0]*r[0]*255<<16)+(t[1]*r[1]*255<<8)+(0|t[2]*r[2]*255);i._tintRGB=(s>>16)+(65280&s)+((255&s)<<16)}}},i.prototype.calculateVertices=function(){var t=this.transform._worldID;if(this._transformID!==t){this._transformID=t;for(var e=this.transform.worldTransform,i=e.a,r=e.b,s=e.c,n=e.d,h=e.tx,a=e.ty,o=this._geometry.points,l=this.vertexData,u=0,p=0;p<o.length;p+=2){var c=o[p],d=o[p+1];l[u++]=i*c+s*d+h,l[u++]=n*d+r*c+a}}},i.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0),this},i.prototype.setMatrix=function(t){return this._matrix=t,this},i.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},i.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},i.prototype.destroy=function(t){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,e.prototype.destroy.call(this,t)},i._TEMP_POINT=new l,i}(M),it={buildPoly:I,buildCircle:R,buildRectangle:B,buildRoundedRectangle:U,buildLine:N,ArcUtils:q,BezierUtils:k,QuadraticUtils:H,BatchPart:Y,FILL_COMMANDS:G,BATCH_POOL:V,DRAW_CALL_POOL:W};export{A as FillStyle,D as GRAPHICS_CURVES,et as Graphics,Q as GraphicsData,J as GraphicsGeometry,T as LINE_CAP,S as LINE_JOIN,K as LineStyle,it as graphicsUtils};
//# sourceMappingURL=graphics.min.js.map
