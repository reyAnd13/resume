/*!
 * @pixi/text-bitmap - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/text-bitmap is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
this.PIXI=this.PIXI||{};var _pixi_text_bitmap=function(t,e,r,i,n,a,s,o,h){"use strict";var l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};var u=function(){return function(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[]}}(),f=function(){function t(){}return t.test=function(t){return"string"==typeof t&&0===t.indexOf("info face=")},t.parse=function(t){var e=t.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[]};for(var i in e){var n=e[i].match(/^[a-z]+/gm)[0],a=e[i].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),s={};for(var o in a){var h=a[o].split("="),l=h[0],f=h[1].replace(/"/gm,""),c=parseFloat(f),p=isNaN(c)?f:c;s[l]=p}r[n].push(s)}var g=new u;return r.info.forEach(function(t){return g.info.push({face:t.face,size:parseInt(t.size,10)})}),r.common.forEach(function(t){return g.common.push({lineHeight:parseInt(t.lineHeight,10)})}),r.page.forEach(function(t){return g.page.push({id:parseInt(t.id,10),file:t.file})}),r.char.forEach(function(t){return g.char.push({id:parseInt(t.id,10),page:parseInt(t.page,10),x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xoffset:parseInt(t.xoffset,10),yoffset:parseInt(t.yoffset,10),xadvance:parseInt(t.xadvance,10)})}),r.kerning.forEach(function(t){return g.kerning.push({first:parseInt(t.first,10),second:parseInt(t.second,10),amount:parseInt(t.amount,10)})}),g},t}(),c=function(){function t(){}return t.test=function(t){return t instanceof XMLDocument&&t.getElementsByTagName("page").length&&null!==t.getElementsByTagName("info")[0].getAttribute("face")},t.parse=function(t){for(var e=new u,r=t.getElementsByTagName("info"),i=t.getElementsByTagName("common"),n=t.getElementsByTagName("page"),a=t.getElementsByTagName("char"),s=t.getElementsByTagName("kerning"),o=0;o<r.length;o++)e.info.push({face:r[o].getAttribute("face"),size:parseInt(r[o].getAttribute("size"),10)});for(o=0;o<i.length;o++)e.common.push({lineHeight:parseInt(i[o].getAttribute("lineHeight"),10)});for(o=0;o<n.length;o++)e.page.push({id:parseInt(n[o].getAttribute("id"),10)||0,file:n[o].getAttribute("file")});for(o=0;o<a.length;o++){var h=a[o];e.char.push({id:parseInt(h.getAttribute("id"),10),page:parseInt(h.getAttribute("page"),10)||0,x:parseInt(h.getAttribute("x"),10),y:parseInt(h.getAttribute("y"),10),width:parseInt(h.getAttribute("width"),10),height:parseInt(h.getAttribute("height"),10),xoffset:parseInt(h.getAttribute("xoffset"),10),yoffset:parseInt(h.getAttribute("yoffset"),10),xadvance:parseInt(h.getAttribute("xadvance"),10)})}for(o=0;o<s.length;o++)e.kerning.push({first:parseInt(s[o].getAttribute("first"),10),second:parseInt(s[o].getAttribute("second"),10),amount:parseInt(s[o].getAttribute("amount"),10)});return e},t}(),p=function(){function t(){}return t.test=function(t){if("string"==typeof t&&t.indexOf("<font>")>-1){var e=(new self.DOMParser).parseFromString(t,"text/xml");return c.test(e)}return!1},t.parse=function(t){var e=(new self.DOMParser).parseFromString(t,"text/xml");return c.parse(e)},t}(),g=[f,c,p];function d(t){for(var e=0;e<g.length;e++)if(g[e].test(t))return g[e];return null}function v(t,e,r,i,n,a){var o,h=r.fill;if(!Array.isArray(h))return h;if(1===h.length)return h[0];var l=r.dropShadow?r.dropShadowDistance:0,u=r.padding||0,f=Math.ceil(t.width/i)-l-2*u,c=Math.ceil(t.height/i)-l-2*u,p=h.slice(),g=r.fillGradientStops.slice();if(!g.length)for(var d=p.length+1,v=1;v<d;++v)g.push(v/d);if(p.unshift(h[0]),g.unshift(0),p.push(h[h.length-1]),g.push(1),r.fillGradientType===s.TEXT_GRADIENT.LINEAR_VERTICAL){o=e.createLinearGradient(f/2,u,f/2,c+u);var x=0,m=(a.fontProperties.fontSize+r.strokeThickness)/c;for(v=0;v<n.length;v++)for(var y=a.lineHeight*v,_=0;_<p.length;_++){var b=y/c+("number"==typeof g[_]?g[_]:_/p.length)*m,w=Math.max(x,b);w=Math.min(w,1),o.addColorStop(w,p[_]),x=w}}else{o=e.createLinearGradient(u,c/2,f+u,c/2);var I=p.length+1,T=1;for(v=0;v<p.length;v++){var A=void 0;A="number"==typeof g[v]?g[v]:T/I,o.addColorStop(A,p[v]),T++}}return o}function x(t,e,r,i,a,s,o){var h=r.text,l=r.fontProperties;e.translate(i,a),e.scale(s,s);var u=o.strokeThickness/2,f=-o.strokeThickness/2;e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=v(t,e,o,s,[h],r),e.strokeStyle=o.stroke,e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=v(t,e,o,s,[h],r),e.strokeStyle=o.stroke;var c=o.dropShadowColor,p=n.hex2rgb("number"==typeof c?c:n.string2hex(c));o.dropShadow?(e.shadowColor="rgba("+255*p[0]+","+255*p[1]+","+255*p[2]+","+o.dropShadowAlpha+")",e.shadowBlur=o.dropShadowBlur,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*o.dropShadowDistance,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*o.dropShadowDistance):(e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),o.stroke&&o.strokeThickness&&e.strokeText(h,u,f+r.lineHeight-l.descent),o.fill&&e.fillText(h,u,f+r.lineHeight-l.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}var m=function(){function t(t,r,i){var s=t.info[0],o=t.common[0],h=t.page[0],l=n.getResolutionOfUrl(h.file),u={};this._ownsTextures=i,this.font=s.face,this.size=s.size,this.lineHeight=o.lineHeight/l,this.chars={},this.pageTextures=u;for(var f=0;f<t.page.length;f++){var c=t.page[f],p=c.id,g=c.file;u[p]=r instanceof Array?r[f]:r[g]}for(f=0;f<t.char.length;f++){var d=t.char[f],v=(p=d.id,d.page),x=t.char[f],m=x.x,y=x.y,_=x.width,b=x.height,w=x.xoffset,I=x.yoffset,T=x.xadvance;m/=l,y/=l,_/=l,b/=l,w/=l,I/=l,T/=l;var A=new e.Rectangle(m+u[v].frame.x/l,y+u[v].frame.y/l,_,b);this.chars[p]={xOffset:w,yOffset:I,xAdvance:T,kerning:{},texture:new a.Texture(u[v].baseTexture,A),page:v}}for(f=0;f<t.kerning.length;f++){var S=t.kerning[f],P=S.first,O=S.second,E=S.amount;P/=l,O/=l,E/=l,this.chars[O]&&(this.chars[O].kerning[P]=E)}}return t.prototype.destroy=function(){for(var t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(var t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null},t.install=function(e,r,i){var n;if(e instanceof u)n=e;else{var s=d(e);if(!s)throw new Error("Unrecognized data format for font.");n=s.parse(e)}r instanceof a.Texture&&(r=[r]);var o=new t(n,r,i);return t.available[o.font]=o,o},t.uninstall=function(e){var r=t.available[e];if(!r)throw new Error("No font found named '"+e+"'");r.destroy(),delete t.available[e]},t.from=function(e,r,i){if(!e)throw new Error("[BitmapFont] Property `name` is required.");var n=Object.assign({},t.defaultOptions,i),o=n.chars,h=n.padding,l=n.resolution,f=n.textureWidth,c=n.textureHeight,p=function(t){"string"==typeof t&&(t=[t]);for(var e=[],r=0,i=t.length;r<i;r++){var n=t[r];if(Array.isArray(n)){if(2!==n.length)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+n.length+".");var a=n[0].charCodeAt(0),s=n[1].charCodeAt(0);if(s<a)throw new Error("[BitmapFont]: Invalid character range.");for(var o=a,h=s;o<=h;o++)e.push(String.fromCharCode(o))}else e.push.apply(e,n.split(""))}if(0===e.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}(o),g=r instanceof s.TextStyle?r:new s.TextStyle(r),d=f,v=new u;v.info[0]={face:g.fontFamily,size:g.fontSize},v.common[0]={lineHeight:g.fontSize};for(var m,y,_,b=0,w=0,I=0,T=[],A=[],S=0;S<p.length;S++){m||((m=document.createElement("canvas")).width=f,m.height=c,y=m.getContext("2d"),_=new a.BaseTexture(m,{resolution:l}),T.push(_),A.push(new a.Texture(_)),v.page.push({id:A.length-1,file:""}));var P=s.TextMetrics.measureText(p[S],g,!1,m),O=P.width,E=Math.ceil(P.height),M=Math.ceil(("italic"===g.fontStyle?2:1)*O);if(w>=c-E*l){if(0===w)throw new Error("[BitmapFont] textureHeight "+c+"px is too small for "+g.fontSize+"px fonts");--S,m=null,y=null,_=null,w=0,b=0,I=0}else if(I=Math.max(E+P.fontProperties.descent,I),M*l+b>=d)--S,w+=I*l,w=Math.ceil(w),b=0,I=0;else{x(m,y,P,b,w,l,g);var k=P.text.charCodeAt(0);v.char.push({id:k,page:A.length-1,x:b/l,y:w/l,width:M,height:E,xoffset:0,yoffset:0,xadvance:Math.ceil(O-(g.dropShadow?g.dropShadowDistance:0)-(g.stroke?g.strokeThickness:0))}),b+=(M+2*h)*l,b=Math.ceil(b)}}S=0;for(var C=p.length;S<C;S++)for(var B=p[S],H=0;H<C;H++){var z=p[H],L=y.measureText(B).width,N=y.measureText(z).width,F=y.measureText(B+z).width-(L+N);F&&v.kerning.push({first:B.charCodeAt(0),second:z.charCodeAt(0),amount:F})}var j=new t(v,A,!0);return void 0!==t.available[e]&&t.uninstall(e),t.available[e]=j,j},t.ALPHA=[["a","z"],["A","Z"]," "],t.NUMERIC=[["0","9"]],t.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],t.ASCII=[[" ","~"]],t.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:t.ALPHANUMERIC},t.available={},t}(),y=[],_=[],b=function(t){function s(i,n){void 0===n&&(n={});var a=t.call(this)||this;a._tint=16777215;var o=Object.assign({},s.styleDefaults,n),h=o.align,l=o.tint,u=o.maxWidth,f=o.letterSpacing,c=o.fontName,p=o.fontSize;if(!m.available[c])throw new Error('Missing BitmapFont "'+c+'"');return a._activePagesMeshData=[],a._textWidth=0,a._textHeight=0,a._align=h,a._tint=l,a._fontName=c,a._fontSize=p||m.available[c].size,a._text=i,a._maxWidth=u,a._maxLineHeight=0,a._letterSpacing=f,a._anchor=new e.ObservablePoint(function(){a.dirty=!0},a,0,0),a._roundPixels=r.settings.ROUND_PIXELS,a.dirty=!0,a._textureCache={},a}return function(t,e){function r(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(s,t),s.prototype.updateText=function(){for(var t,r=m.available[this._fontName],s=this._fontSize/r.size,o=new e.Point,h=[],l=[],u=[],f=this._text.replace(/(?:\r\n|\r)/g,"\n")||" ",c=f.length,p=this._maxWidth*r.size/this._fontSize,g=null,d=0,v=0,x=0,b=-1,w=0,I=0,T=0,A=0,S=0;S<c;S++){var P=f.charCodeAt(S),O=f.charAt(S);if(/(?:\s)/.test(O)&&(b=S,w=d,A++),"\r"!==O&&"\n"!==O){var E=r.chars[P];if(E){g&&E.kerning[g]&&(o.x+=E.kerning[g]);var M=_.pop()||{texture:a.Texture.EMPTY,line:0,charCode:0,prevSpaces:0,position:new e.Point};M.texture=E.texture,M.line=x,M.charCode=P,M.position.x=o.x+E.xOffset+this._letterSpacing/2,M.position.y=o.y+E.yOffset,M.prevSpaces=A,h.push(M),o.x+=E.xAdvance+this._letterSpacing,d=o.x,T=Math.max(T,E.yOffset+E.texture.height),g=P,-1!==b&&p>0&&o.x>p&&(++I,n.removeItems(h,1+b-I,1+S-b),S=b,b=-1,l.push(w),u.push(h.length>0?h[h.length-1].prevSpaces:0),v=Math.max(v,w),x++,o.x=0,o.y+=r.lineHeight,g=null,A=0)}}else l.push(d),u.push(-1),v=Math.max(v,d),++x,++I,o.x=0,o.y+=r.lineHeight,g=null,A=0}var k=f.charAt(f.length-1);"\r"!==k&&"\n"!==k&&(/(?:\s)/.test(k)&&(d=w),l.push(d),v=Math.max(v,d),u.push(-1));var C=[];for(S=0;S<=x;S++){var B=0;"right"===this._align?B=v-l[S]:"center"===this._align?B=(v-l[S])/2:"justify"===this._align&&(B=u[S]<0?0:(v-l[S])/u[S]),C.push(B)}var H=h.length,z={},L=[],N=this._activePagesMeshData;for(S=0;S<N.length;S++)y.push(N[S]);for(S=0;S<H;S++){var F=(J=h[S].texture).baseTexture.uid;if(!z[F]){if(!(tt=y.pop())){var j=new i.MeshGeometry,D=new i.MeshMaterial(a.Texture.EMPTY);tt={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:new i.Mesh(j,D),vertices:null,uvs:null,indices:null}}tt.index=0,tt.indexCount=0,tt.vertexCount=0,tt.uvsCount=0,tt.total=0;var X=this._textureCache;X[F]=X[F]||new a.Texture(J.baseTexture),tt.mesh.texture=X[F],tt.mesh.tint=this._tint,L.push(tt),z[F]=tt}z[F].total++}for(S=0;S<N.length;S++)-1===L.indexOf(N[S])&&this.removeChild(N[S].mesh);for(S=0;S<L.length;S++)L[S].mesh.parent!==this&&this.addChild(L[S].mesh);for(var S in this._activePagesMeshData=L,z){var W=(tt=z[S]).total;if(!((null===(t=tt.indices)||void 0===t?void 0:t.length)>6*W)||tt.vertices.length<2*i.Mesh.BATCHABLE_SIZE)tt.vertices=new Float32Array(8*W),tt.uvs=new Float32Array(8*W),tt.indices=new Uint16Array(6*W);else for(var U=tt.total,R=tt.vertices,G=4*U*2;G<R.length;G++)R[G]=0;tt.mesh.size=6*W}for(S=0;S<H;S++){var Y=(O=h[S]).position.x+C[O.line]*("justify"===this._align?O.prevSpaces:1);this._roundPixels&&(Y=Math.round(Y));var J,Z=Y*s,$=O.position.y*s,V=z[(J=O.texture).baseTexture.uid],q=J.frame,K=J._uvs,Q=V.index++;V.indices[6*Q+0]=0+4*Q,V.indices[6*Q+1]=1+4*Q,V.indices[6*Q+2]=2+4*Q,V.indices[6*Q+3]=0+4*Q,V.indices[6*Q+4]=2+4*Q,V.indices[6*Q+5]=3+4*Q,V.vertices[8*Q+0]=Z,V.vertices[8*Q+1]=$,V.vertices[8*Q+2]=Z+q.width*s,V.vertices[8*Q+3]=$,V.vertices[8*Q+4]=Z+q.width*s,V.vertices[8*Q+5]=$+q.height*s,V.vertices[8*Q+6]=Z,V.vertices[8*Q+7]=$+q.height*s,V.uvs[8*Q+0]=K.x0,V.uvs[8*Q+1]=K.y0,V.uvs[8*Q+2]=K.x1,V.uvs[8*Q+3]=K.y1,V.uvs[8*Q+4]=K.x2,V.uvs[8*Q+5]=K.y2,V.uvs[8*Q+6]=K.x3,V.uvs[8*Q+7]=K.y3}for(var S in this._textWidth=v*s,this._textHeight=(o.y+r.lineHeight)*s,z){var tt=z[S];if(0!==this.anchor.x||0!==this.anchor.y)for(var et=0,rt=this._textWidth*this.anchor.x,it=this._textHeight*this.anchor.y,nt=0;nt<tt.total;nt++)tt.vertices[et++]-=rt,tt.vertices[et++]-=it,tt.vertices[et++]-=rt,tt.vertices[et++]-=it,tt.vertices[et++]-=rt,tt.vertices[et++]-=it,tt.vertices[et++]-=rt,tt.vertices[et++]-=it;this._maxLineHeight=T*s;var at=tt.mesh.geometry.getBuffer("aVertexPosition"),st=tt.mesh.geometry.getBuffer("aTextureCoord"),ot=tt.mesh.geometry.getIndex();at.data=tt.vertices,st.data=tt.uvs,ot.data=tt.indices,at.update(),st.update(),ot.update()}for(S=0;S<h.length;S++)_.push(h[S])},s.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},s.prototype.getLocalBounds=function(){return this.validate(),t.prototype.getLocalBounds.call(this)},s.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},Object.defineProperty(s.prototype,"tint",{get:function(){return this._tint},set:function(t){if(this._tint!==t){this._tint=t;for(var e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"fontName",{get:function(){return this._fontName},set:function(t){if(!m.available[t])throw new Error('Missing BitmapFont "'+t+'"');this._fontName!==t&&(this._fontName=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"anchor",{get:function(){return this._anchor},set:function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"text",{get:function(){return this._text},set:function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),s.prototype.destroy=function(e){var r=this._textureCache;for(var i in r){r[i].destroy(),delete r[i]}this._textureCache=null,t.prototype.destroy.call(this,e)},s.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0},s}(o.Container),w=function(){function t(){}return t.add=function(){h.LoaderResource.setExtensionXhrType("fnt",h.LoaderResource.XHR_RESPONSE_TYPE.TEXT)},t.use=function(e,r){var i=d(e.data);if(i)for(var n=t.getBaseUrl(this,e),a=i.parse(e.data),s={},o=function(t){s[t.metadata.pageFile]=t.texture,Object.keys(s).length===a.page.length&&(e.bitmapFont=m.install(a,s,!0),r())},l=0;l<a.page.length;++l){var u=a.page[l].file,f=n+u,c=!1;for(var p in this.resources){var g=this.resources[p];if(g.url===f){g.metadata.pageFile=u,g.texture?o(g):g.onAfterMiddleware.add(o),c=!0;break}}if(!c){var v={crossOrigin:e.crossOrigin,loadType:h.LoaderResource.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:u},e.metadata.imageMetadata),parentResource:e};this.add(f,v,o)}}else r()},t.getBaseUrl=function(e,r){var i=r.isDataUrl?"":t.dirname(r.url);return r.isDataUrl&&("."===i&&(i=""),e.baseUrl&&i&&"/"===e.baseUrl.charAt(e.baseUrl.length-1)&&(i+="/")),(i=i.replace(e.baseUrl,""))&&"/"!==i.charAt(i.length-1)&&(i+="/"),i},t.dirname=function(t){var e=t.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===t?".":""===e?"/":e},t}();return t.BitmapFont=m,t.BitmapFontData=u,t.BitmapFontLoader=w,t.BitmapText=b,t}({},PIXI,PIXI,PIXI,PIXI.utils,PIXI,PIXI,PIXI,PIXI);Object.assign(this.PIXI,_pixi_text_bitmap);
//# sourceMappingURL=text-bitmap.min.js.map
